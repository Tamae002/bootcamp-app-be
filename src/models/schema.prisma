generator client {
  provider = "prisma-client-js"
  output   = "../../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model user {
  user_id              String                 @id(map: "User_pkey") @default(cuid()) @db.VarChar(36)
  name                 String?                @db.VarChar(255)
  email                String                 @db.VarChar(255)
  password             String                 @db.VarChar(255)
  role                 user_role_enum
  gambar               String?                @db.VarChar(255)
  isActive             Boolean?               @default(true)
  createdAt            DateTime?              @default(now()) @db.Timestamp(6)
  updatedAt            DateTime?              @default(now()) @db.Timestamp(6)
  anggota              anggota_kelas[]
  jawaban              jawaban[]
  reset_password_token reset_password_token[]
  sessions             session[]
}

model kelas {
  kelas_id         String          @id(map: "Kelas_pkey") @default(cuid()) @map("Kelas_id") @db.VarChar(36)
  nama_kelas       String          @unique(map: "Kelas_nama_kelas_unique") @db.VarChar(255)
  gambar           String?         @db.VarChar(255)
  deskripsi        String?         @db.VarChar(255)
  tanggal_mulai    DateTime?       @db.Timestamp(6)
  tanggal_berakhir DateTime?       @db.Timestamp(6)
  isActive         Boolean?        @default(true)
  createdAt        DateTime?       @default(now()) @db.Timestamp(6)
  updatedAt        DateTime?       @default(now()) @db.Timestamp(6)
  anggota          anggota_kelas[]
  pertemuan        pertemuan[]
}

model pertemuan {
  pertemuan_id    String    @id(map: "Pertemuan_pkey") @default(cuid()) @map("Pertemuan_id") @db.VarChar(36)
  kelas_id        String?   @db.VarChar(36)
  judul           String    @db.VarChar(255)
  tanggal         DateTime  @db.Timestamp(6)
  deskripsi_tugas String?   @db.VarChar(255)
  isActive        Boolean?  @default(true)
  createdAt       DateTime? @default(now()) @db.Timestamp(6)
  updatedAt       DateTime? @default(now()) @db.Timestamp(6)
  jawaban         jawaban[]
  kelas           kelas?    @relation(fields: [kelas_id], references: [kelas_id], onDelete: Cascade, onUpdate: NoAction, map: "Pertemuan_kelas_id_fkey")
}

model anggota_kelas {
  anggota_kelas_id String    @default(cuid()) @db.VarChar(36)
  user_id          String    @db.VarChar(36)
  kelas_id         String    @db.VarChar(36)
  isActive         Boolean?  @default(true)
  createdAt        DateTime? @default(now()) @db.Timestamp(6)
  updatedAt        DateTime? @default(now()) @db.Timestamp(6)
  kelas            kelas     @relation(fields: [kelas_id], references: [kelas_id], onDelete: Cascade, onUpdate: NoAction, map: "anggota_Kelas_kelas_id_fkey")
  user             user      @relation(fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction, map: "anggota_Kelas_user_id_fkey")

  @@id([user_id, kelas_id], map: "anggota_Kelas_pkey")
}

model jawaban {
  jawaban_id   String               @id @default(cuid()) @db.VarChar(36)
  pertemuan_id String?              @db.VarChar(36)
  user_id      String?              @db.VarChar(36)
  file_path    String?              @db.VarChar(255)
  nilai        Int?                 @db.SmallInt
  status       jawaban_status_enum? @default(menunggu_nilai)
  isActive     Boolean?             @default(true)
  createdAt    DateTime?            @default(now()) @db.Timestamp(6)
  updatedAt    DateTime?            @default(now()) @db.Timestamp(6)
  pertemuan    pertemuan?           @relation(fields: [pertemuan_id], references: [pertemuan_id], onDelete: Cascade, onUpdate: NoAction, map: "Jawaban_pertemuan_id_fkey")
  user         user?                @relation(fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction, map: "Jawaban_user_id_fkey")
}

model session {
  session_id String    @id @default(cuid()) @db.VarChar(36)
  user_id    String?   @db.VarChar(36)
  token      String
  isActive   Boolean?  @default(true)
  createdAt  DateTime? @default(now()) @db.Timestamp(6)
  updatedAt  DateTime? @default(now()) @db.Timestamp(6)
  user       user?     @relation(fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction)
}

model reset_password_token {
  id_rp_token String   @id @default(cuid()) @db.VarChar(36)
  id_user     String   @db.VarChar(36)
  token       String   @db.VarChar(255)
  expires_at  DateTime @db.Timestamp(6)
  user        user     @relation(fields: [id_user], references: [user_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_user")
}

enum user_role_enum {
  admin
  teacher
  student
  user
}

enum jawaban_status_enum {
  menunggu_nilai @map("menunggu nilai")
  sudah_dinilai  @map("sudah dinilai")
  menunggu
  dinilai
}

enum Role {
  admin
  user
}

enum StatusJawaban {
  menunggu
  dinilai
}
